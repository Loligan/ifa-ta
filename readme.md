# All4Bom TA V2

Порт базы: 3316 *u: user | p: pass*

Порт supervisor: 9002  *u: www | p: iaw*

Порт rabbit: 15673 *u: ta | p: 6omKUdBf*


### DB

| Schema | Desc | 
| ------ | ------ |
|scenario| Сценарий, параметр isSmoke указывает на то является ли сценарий смоуком|
|queue_test|сценарий в очереди, при отправки сценария на выполнения создается queue_test, в сущности есть статусы выполнения: fail,pass,in progress, при fail создается две сущности, behat_report, console_report, image_report|
|behat_report|Описание пройденных и fail шагов при выполнении сценария|
|console_report|сценарии запускаются через bash, поэтому есть консольный вывод который записывается в эту сущность, там можно посмотреть суть проблемы более подробно|
|image_report|путь до последних скриншотов сценария (5 и менее)|

### Commands

|# | Command | Desc | 
| ------ | ------ | ------ |
|1| ta-core:generate:sqlite-db  |  создает варианты сценарий в базе данных sqlite |
|2|  ta-core:push:test-in-db  | создает сценарии в базе данных MySQL|
|3|  ta-core:run:all  | отправляет в очередь на выполнение все сценарии|
|4| ta-core:run:smoke  |отправляет в очередь на выполнение все сценарии с отметкой true в столбце isSmoke |
|5| ta:rerun | **[test range] [start id] [finishId]**, все три параметра не обязательны, если хотите отправить на выполнение все зафейленные тесты последнего круга то вызовите поросто команду без парамтеров, если нужно вызвать все зафейленные тесты то введите команду и номер круга, например ta:rerun 1, тогда на выполнение отправятся все зафэйленные тесты 1 круга, если нужно выполнить зафейленные тесты начиная с определенной id test_queue, то введите ta:rerun 1 40 (первый параметр т.е. test_range будет игнорироваться), если нужно указать последний id для отправки то укажите третьим параметром последний id, например ta:rerun 1 40 50, отправятся все зафейленные тесты от 40 по 50 id


При первой установке необходимо выполнить в следующей последовательности **1 ->2**

При обновлении вариантов в sqlite или необходимо выполнить только **2**

При обновлении данных в сборщиках тестов необходимо выполнить  **1 -> 2**


### SQLite files

Собранная база SQLite находится:

| File | Desc | 
| ------ | ------ |
| src/TestAutomationCoreBundle/Resource/SQLiteDB/feature | База содержит таблицу feature описание и имена таблиц с вариантами в базе **scenario** |
| src/TestAutomationCoreBundle/Resource/SQLiteDB/scenario | База содержит таблицы с вариантами переменных для сценариев |

Если хотите добавить свой вариант сценария, посмотрите в базе **feature** имя таблицы нужного вам сценария, и найдите данную таблицу в базе **scenario**, после чего просто добавьте нужные вам варианты и сохрание.

